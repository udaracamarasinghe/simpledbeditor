<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<title>Configuration Editor</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

<link rel="stylesheet" type="text/css"
	href="webjars/bootstrap/3.3.7/css/bootstrap.min.css" />

<link rel="stylesheet" th:href="@{/css/main.css}"
	href="../../css/main.css" />

<script type="text/javascript" src="../../js/jquery-3.2.1.min.js">
	</script>
<script type="text/javascript" src="../../js/notify.min.js">
	</script>

<script th:inline="javascript">
/*<![CDATA[*/
    
    $( document ).ready(function() {
    	var message = /*[[${formMessage}]]*/ ;

        if(message !== null)
    	$.notify(message, {autoHideDelay: 60000, className: 'success'});

        var errorMessage = /*[[${formErrorMessage}]]*/ ;

        if(errorMessage !== null)
    	$.notify(errorMessage,  {autoHideDelay: 60000, className: 'error'});
    	
    });
 
    $( window ).on( "load", function() {
        console.log( "window loaded" );
    });
    /*]]>*/
    </script>

<style type="text/css">
.delete-button {
	background-image: url(../../images/Files-Delete-File-icon.png);
	background-color: transparent;
	background-repeat: no-repeat;
	background-position: 0px 0px;
	border: none;
	cursor: pointer;
	height: 40px;
	padding-left: 40px;
	vertical-align: middle;
}

.edit-button {
	background-image: url(../../images/Files-Edit-File-icon.png);
	background-color: transparent;
	background-repeat: no-repeat;
	background-position: 0px 0px;
	border: none;
	cursor: pointer;
	height: 40px;
	padding-left: 40px;
	vertical-align: middle;
}

.overlay {
	position: inherit;
	top: 2;
	right: 0;
	padding-right: 100;
	left: 100;
	border-radius: 4px;
	border: 1px solid rgba(221, 221, 221, 0.5);
	width: auto;
	height: auto;
	z-index: 10;
	background: rgba(221, 221, 221, 0.5);
	border-radius: 4px; /*dim the background*/
}

footer {
	position: fixed;
	height: auto;
	bottom: 0;
	width: 100%;
	padding: 0.4%;
	background-color: white;
	border-top: 1px solid #ddd;
}
</style>
</head>
<body>

	<nav class="navbar navbar-inverse" style="background-color: #3b5998;">
		<div class="container col-md-12">
			<div class="navbar-header col-md-12">
				<div class="navbar-brand col-md-8">
					<a style="color: white;" href="#"><span
						th:text="${headerTitle}"></span> </a>
				</div>

				<div th:fragment="logout" class="navbar-right" style="color: white;"
					align="right" sec:authorize="isAuthenticated()">

					<div>
						<section id="loginDetails" th:if="${loingdetailsShow == true}">
							<form class="navbar-form" action="#" th:action="@{/logout}"
								method="post">
								logged as: <span sec:authentication="name"></span> :
								<button class="form-control" type="submit">Logout</button>
							</form>
						</section>
					</div>
				</div>
			</div>

		</div>
	</nav>

	<div class="container col-md-12" style="padding-bottom: 2%;">
		<div class="starter-template form-group">
			<form th:action="${contextPath}" th:object="${configCtrlPageModel}"
				method="POST">

				<div class="row">

					<div class="col-md-1">
						<label for="modules">Modules:</label>
					</div>
					<div class="col-md-4">
						<!--   input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" / -->
						<select class="form-control" name="exampltte" id="modules"
							onchange='this.form.submit()'
							th:value="${selectedConfigPluginWrapperId}"
							th:field="*{selectedConfigPluginWrapperId}">
							<option value="0">[PLEASE SELECT]</option>
							<option th:each="module : ${modules}" th:value="${module}"
								th:text="${module}"></option>
						</select>
					</div>
					<div class="col-md-2" align="left">
						<label for="modules">Configuration Types:</label>
					</div>
					<div class="col-md-5">

						<!-- input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" / -->
						<select class="form-control" name="exampleii" id="configs"
							th:value="${selectedConfigId}" th:field="*{selectedConfigId}"
							onchange='this.form.submit()'>
							<option value="0">[PLEASE SELECT]</option>
							<option th:each="config : ${configs}" th:value="${config}"
								th:text="${config}"></option>
						</select>
					</div>

				</div>

			</form>

			<div class="row">
				<div class="col-md-12" style="height: 20px;"></div>
			</div>

			<section id="editorSection" th:if="${columnNames != null}">
				<div class="row">
					<div class="col-md-1">
						<label>Configurations:</label>
					</div>

					<section id="entriesSection" th:if="${columnValues != null}">
						<div class="table-responsive col-md-11">
							<table class="table table-striped">
								<tr>
									<th:block th:each="columnName : ${columnNames}">
										<th th:text="${columnName}"></th>
									</th:block>
									<th></th>
									<th></th>
								</tr>
								<th:block th:each="columnValue : ${columnValues}">
									<tr>
										<th:block th:each="colVal : ${columnValue.values}">
											<td th:text="${colVal}"></td>
										</th:block>
										<td>
											<form action="#"
												th:action="@{{editRow}/{editRowId}(editRowId=${columnValue.id},editRow=${editRow})}"
												th:object="${configCtrlPageModel}" method="POST">
												<!-- input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" / -->
												<input type="hidden" th:value="${columnValue.id}"
													th:name="editRowId" />
												<button class="edit-button" type="submit" title="edit item"
													name="edit"></button>
											</form>
										</td>
										<td>
											<form action="#"
												th:action="@{/config/deleteRow/{editRowId}(editRowId=${columnValue.id})}"
												th:object="${configCtrlPageModel}" method="POST">
												<!-- input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" / -->
												<input type="hidden" th:value="${columnValue.id}"
													th:name="editRowId" />
												<button class="delete-button" title="delete item"
													onclick="return confirm('Are you sure you want to delete this item?');"
													type="submit" name="del"></button>
											</form>
										</td>
									</tr>
								</th:block>
								<tr>
									<td colspan="100">
										<table>
											<tr>
												<td align="left">
													<form action="#" th:object="${configCtrlPageModel}"
														th:action="@{/config/newEntry}" method="POST">
														<!-- input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" / -->
														<button class="form-control btn-primary" type="submit"
															name="add" th:text="'ADD'"></button>
													</form>
												</td>
											</tr>
										</table>
									</td>
								</tr>
							</table>
						</div>
					</section>
					<section id="entriesSection" th:if="${columnValues == null}">
						<form action="#" th:object="${configCtrlPageModel}"
							th:action="@{/config/newEntry}" method="POST">
							<!-- input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" / -->
							<button class="form-control btn-primary" type="submit" name="add"
								th:text="'ADD'"></button>
						</form>
					</section>
				</div>
			</section>



			<div class="row">
				<div class="col-md-12" style="height: 20px;"></div>
			</div>

			<section id="editorSection" th:if="${editorModel != null}">

				<div class="row">
					<div class="col-md-1">
						<label>Editor:</label>
					</div>
					<div class="table-responsive col-md-11">
						<form action="#" th:action="@{/config/editor/save}"
							th:object="${editorModel}" method="POST" accept-charset="utf-8">
							<!-- input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" / -->
							<div class="alert alert-danger" th:if="${#fields.hasErrors('*')}">
								<p th:each="err : ${#fields.errors('*')}" th:text="${err}"></p>
							</div>
							<input type="hidden" th:field="*{editId}" th:value="${editId}" />
							<input type="hidden" th:field="*{editType}"
								th:value="${editType}" />
							<table class="table table-striped">

								<th:block th:each="field, stat : *{editorFields}">
									<tr>
										<th th:text="${field.name}"></th>
										<td>:</td>
										<td width="100%">
											<section id="feildTypeSection"
												th:if="${field.fieldType == T(org.uca.uies.api.simpledbeditorl.enums.FieldType).TEXT_FIELD}">
												<input class="form-control" type="text"
													th:field="*{editorFields[__${stat.index}__].value}"
													value="*{field.value}" th:placeholder="${field.dataType}" />
											</section>
											<section id="feildTypeSection"
												th:if="${field.fieldType == T(org.uca.uies.api.simpledbeditorl.enums.FieldType).TEXT_AREA}">
												<textarea class="form-control" rows="8"
													th:field="*{editorFields[__${stat.index}__].value}"
													value="*{field.value}" th:placeholder="${field.dataType}"
													name="notes" th:inline="text"></textarea>
											</section> <input class="form-control" type="hidden"
											th:field="*{editorFields[__${stat.index}__].name}"
											value="*{field.name}" />
										</td>
									</tr>
								</th:block>
								<tr>
									<td>
										<table>
											<tr>
												<td align="left"><button
														class="form-control btn-primary" type="submit"
														name="saveFormReq" th:text="'SAVE'" th:value="SAVE">SAVE</button></td>
											</tr>
										</table>
									</td>
									<td></td>
									<td align="right"><table>
											<tr>
												<td align="right">
													<button class="form-control btn-warning" type="submit"
														onclick="return confirm('Are you sure you want to cancel?');"
														name="saveFormReq" th:text="'CANCEL'" th:value="CANCEL">CANCEL</button>
												</td>
											</tr>
										</table></td>
								</tr>
							</table>
						</form>
					</div>
				</div>
			</section>
		</div>
	</div>

	<footer class="footer text-center">
		<div>
			<span th:text="${footerTitle}"></span>
		</div>
	</footer>

	<script type="text/javascript"
		src="webjars/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</body>
</html>